(function(a){var b=function(a){function c(){var a=$(b.root);d(a);f(a);g(a);h(a)}function d(a){a.on("click","[data-act]",function(a){e("click",a)});a.on("mousedown","[data-act]",function(a){e("mousedown",a)});a.on("mouseup","[data-act]",function(a){e("mouseup",a)});a.on("dblclick","[data-act]",function(a){e("dblclick",a)});a.on("change","[data-act]",function(a){e("change",a)});a.on("keydown","[data-act]",function(a){e("keydown",a)});a.on("keyup","[data-act]",function(a){e("keyup",a)})}function e(a,c){var d=c.currentTarget;var e=i($(d).data("act"));var f=e.func,g=e.key,h=e.type?e.type:"click";if(h==a){if(!g){if(b.act[f]){b.act[f].call(b,c)}else{throw new Error("VOJS_ACT_ERR: "+f+" is not defined")}}else{if(b.act[f]){b.act[f].call(b,c,g)}else{throw new Error("VOJS_ACT_ERR: "+f+" is not defined")}}}}function f(a){var b=[],c=[];var d=a.find("[data-bind]");d.each(function(a){var e=$(this),f=e.data("bind"),g=i(f);if(!g.key){c.push({name:g.func,elem:this})}else{b.push({func:g.func,key:g.key,data:e.get(0)})}if(d.size()==a+1){l(b);k(c)}})}function g(a){var c=[];var d=a.find("[data-tag],[id]");d.each(function(a){var e=$(this),f=false,g=e.data("tag"),h=i(g);if(h.type){throw new Error("VOJS_TAG_ERR: invalid expression")}if(typeof g!="string"){g=this.id;f=true}if(g.indexOf(":")==-1||f){b.tag[g]=e.get(0)}else{c.push({func:h.func,key:h.key,data:e.get(0)})}if(d.size()==a+1){for(var a in c){if(!b.tag[c[a].func]){b.tag[c[a].func]=new Object}b.tag[c[a].func][c[a].key]=c[a].data}}})}function h(a){$("body").find("script[type*=template]").each(function(c){var d=$(this).data("tpl"),e="body",h="";if(!d)return;if(d.indexOf(":")==-1){h=d}else{var i=d.split(":"),e="#"+i[0],h=i[1]}var j=$(e).find("[data-tpl="+h+"]"),k=$(this).html();var l=function(){var c=j,d=arguments[0];if(typeof d=="string"){c=a.find("#"+arguments[0]);d=arguments[1]?arguments[1]:{};h=arguments[0]}c.html(_.template(k,d));f(c);g(c);if(b.tag[h]){b.tag[h]=c.get(0)}return c.get(0)};b.tpl[h]=l})}function i(a){var b=null,c=null,d=null;if(a){if(a.indexOf("#")!=-1){var e=a.split("#");d=e[1],a=e[0]}if(a.indexOf(":")!=-1){var e=a.split(":");b=e[1],c=e[0]}else{c=a}}return{key:b,func:c,type:d}}function j(a,b){var c=i($(a).data("bind")),d=c.type;if(!d){if(a.value==undefined)$(a).html(b);else $(a).val(b)}else{if(d.indexOf(".")!=-1){var e=d.split(".");if(e[0]=="css"){$(a).css(e[1],b)}else if(e[1]=="attr"){$(a).attr(e[1],b)}}else{$(a).css(d,b)}}}function k(a){var c=new Object;for(var d in a){var e=a[d];if(!c[e.name])c[e.name]=[];c[e.name].push(e.elem)}for(var f in c){(function(a){b.bindMultiProc=function(b){var d=c[a];for(var e in d){var f=d[e];j(f,b)}return d.length>1?d:d[0]}})(f);b.bind[f]=b.bindMultiProc}}function l(a){for(var c in a){var d=a[c].func;(function(c){b.funcMultiProc=function(b,d){var f=e(a,c,b);j(f,d);return f}})(d);function e(a,b,c){for(var d in a){var e=a[d];if(e.func==b&&e.key==c){return e.data}}}b.bind[d]=b.funcMultiProc}}function m(a,b,c){function f(a){if(a.value==undefined)return $(a).html();else return $(a).val()}function g(b){var c=b.cmd,d=b.elem;if(a=="bind"){if(!c.type){return f(d)}else{if(c.type.indexOf(".")!=-1){var e=c.type.split(".");if(e[0]=="css"){return $(d).css(e[1])}else if(e[1]=="attr"){return $(d).attr(e[1])}}else{return $(d).css(c.type)}}}else{return f(d)}}var d="[data-"+a+"]"+(a=="tag"?",#"+b:""),e=[];$(d).each(function(c){var d=$(this).data(a);if(a=="tag"&&!d)d=this.id;var f=i(d);if(b==f.func){e.push({cmd:f,elem:this})}});return function(a){if(a.length==1&&!a[0].cmd.key){if(c)return a[0].elem;else return g(a[0])}else{var d=new Object,e=0;for(var f in a){if(typeof a[f]!="function"){var h=a[f].cmd;if(h.key){b=h.key}else{b=e;e++}if(c)d[b]=a[f].elem;else d[b]=g(a[f])}}return d}}(e)}var b=this;b.root=a?$("#"+a).get(0):$("body").get(0),b.act={},b.bind={},b.tag={},b.tpl={};b.bind.get=function(a){return m("bind",a,true)};b.tag.get=function(a){return m("tag",a,true)};b.act.get=function(a){return m("act",a,true)};b.bind.val=function(a){return m("bind",a,false)};b.tag.val=function(a){return m("tag",a,false)};b.act.val=function(a){return m("act",a,false)};c()};var c=function(a,b,c){if(typeof b!="string")throw new Error("VOJS_CRITICAL_ERR: is not an tplId");var d=$("#"+b);if(d.attr("type")!="text/template")throw new Error("VOJS_CRITICAL_ERR: is not a template tag");var e="_"+(new Date).getTime()+"_",f=_.template(d.html(),_.extend({viewId:e},c&&c.params?c.params:{})),g=c&&c.targetId?$("#"+c.targetId):$("body");if(f.indexOf("<script")!=-1)throw new Error("VOJS_CRITICAL_ERR: script tag should not be used");if(g.size()==0)throw new Error("VOJS_CRITICAL_ERR: the target does not exist");return{viewId:e,targetSel:g,tplHtml:f}};b.applyTo=function(a,c){if(typeof a!="object")throw new Error("VOJS_CRITICAL_ERR: is not an object");_.extend(a,new b(c))};b.appendTo=function(a,d,e){var f=c(a,d,e);f.targetSel.append(f.tplHtml);b.applyTo(a,f.viewId)};b.prependTo=function(a,d,e){var f=c(a,d,e);f.targetSel.prepend(f.tplHtml);b.applyTo(a,f.viewId)};b.includeTpl=function(){var a=b.includePath?b.includePath:"",c=b.includeExt?b.includeExt:"tpl",d=arguments.length;if(typeof arguments[d-1]=="object"){var e=arguments[d-1];a=e.path?e.path:a;c=e.ext?e.ext:c}for(var f in arguments){var g=arguments[f],h="",i="body";if(typeof g=="string"){if(g.indexOf(":")!=-1){var j=g.split(":"),i="#"+j[0],h=a+"/"+j[1]+"."+c}else{h=a+"/"+g+"."+c}$.ajax({url:h,method:"GET",async:false,success:function(a){$(i).append(a)}})}}};a.vo=b})(window)