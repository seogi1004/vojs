(function(e){var t=function(e,t,n){var r={},i={};var s=Array.prototype,o=s.slice,u=s.forEach;var a={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var f in a)a[a[f]]=f;var l=/\\|'|\r|\n|\t|\u2028|\u2029/g,c=/\\(\\|'|r|n|t|u2028|u2029)/g,h=/.^/;var p=function(e){return e.replace(c,function(e,t){return a[t]})};var d=r.each=r.forEach=function(e,t,n){if(e==null)return;if(u&&e.forEach===u){e.forEach(t,n)}else if(e.length===+e.length){for(var s=0,o=e.length;s<o;s++){if(s in e&&t.call(n,e[s],s,e)===i)return}}else{for(var a in e){if(r.has(e,a)){if(t.call(n,e[a],a,e)===i)return}}}};r.has=function(e,t){return hasOwnProperty.call(e,t)};r.defaults=function(e){d(o.call(arguments,1),function(t){for(var n in t){if(e[n]==null)e[n]=t[n]}});return e};r.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};r.template=function(e,t,n){n=r.defaults(n||{},r.templateSettings);var i="__p+='"+e.replace(l,function(e){return"\\"+a[e]}).replace(n.escape||h,function(e,t){return"'+\n_.escape("+p(t)+")+\n'"}).replace(n.interpolate||h,function(e,t){return"'+\n("+p(t)+")+\n'"}).replace(n.evaluate||h,function(e,t){return"';\n"+p(t)+"\n;__p+='"})+"';\n";if(!n.variable)i="with(obj||{}){\n"+i+"}\n";i="var __p='';"+"var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+i+"return __p;\n";var s=new Function(n.variable||"obj","_",i);if(t)return s(t,r);var o=function(e){return s.call(this,e,r)};o.source="function("+(n.variable||"obj")+"){\n"+i+"}";return o};return r.template(e,t,n)};var n=function(e,n,r,i){if(typeof e!="object")throw new Error("VOJS_CRITICAL_ERR: is not an object");if(typeof n!="string")throw new Error("VOJS_CRITICAL_ERR: is not an template id");if(typeof r!="string")throw new Error("VOJS_CRITICAL_ERR: is not an target id");var s=$("#"+n);if(s.attr("type")!="text/template")throw new Error("VOJS_CRITICAL_ERR: is not a template tag");var o="VOJS_"+(new Date).getTime();var u=$.extend({viewId:o},i),a=t(s.html(),u),f=r?$("#"+r):$("body");if(a.indexOf("<script")!=-1)throw new Error("VOJS_CRITICAL_ERR: script tag should not be used");if(f.size()==0)throw new Error("VOJS_CRITICAL_ERR: the target does not exist");return{viewId:o,targetSel:f,tplHtml:a}};var r=function(e){function r(){var e=$(n.root);i(e);o(e);u(e);a(e)}function i(e){e.on("click","[data-act]",function(e){s("click",e)});e.on("mousedown","[data-act]",function(e){s("mousedown",e)});e.on("mouseup","[data-act]",function(e){s("mouseup",e)});e.on("dblclick","[data-act]",function(e){s("dblclick",e)});e.on("change","[data-act]",function(e){s("change",e)});e.on("keydown","[data-act]",function(e){s("keydown",e)});e.on("keyup","[data-act]",function(e){s("keyup",e)})}function s(e,t){var r=t.currentTarget;var i=f($(r).data("act"));var s=i.func,o=i.key,u=i.type?i.type:"click";if(u==e){if(!o){if(n.act[s]){n.act[s].call(n,t)}else{}}else{if(n.act[s]){n.act[s].call(n,t,o)}else{}}}}function o(e){var t=[],n=[];var r=e.find("[data-bind]");r.each(function(e){var i=$(this),s=i.data("bind"),o=l(s);var u=o.length>0?o:[o];for(var a in u){var f=u[a];if(!f.key){n.push({name:f.func,elem:this})}else{t.push({func:f.func,key:f.key,data:i.get(0)})}}if(r.size()==e+1){p(t);h(n)}})}function u(e){var t=[];var r=e.find("[data-tag],[id]");r.each(function(e){var i=$(this),s=false,o=i.data("tag"),u=f(o);if(u.type){throw new Error("VOJS_TAG_ERR: invalid expression")}if(typeof o!="string"){o=this.id;s=true}if(o.indexOf(":")==-1||s){n.tag[o]=i.get(0)}else{t.push({func:u.func,key:u.key,data:i.get(0)})}if(r.size()==e+1){for(var e in t){if(!n.tag[t[e].func]){n.tag[t[e].func]=new Object}n.tag[t[e].func][t[e].key]=t[e].data}}})}function a(e){$("body").find("script[type*=template]").each(function(r){var i=$(this).data("tpl"),s="body",a="";if(!i)return;if(i.indexOf(":")==-1){a=i}else{var f=i.split(":"),s="#"+f[0],a=f[1]}var l=$(s).find("[data-tpl="+a+"]").not("script"),c=$(this).html();var h=function(){var r=l,i=arguments[0];if(typeof i=="string"){r=e.find("#"+arguments[0]);i=arguments[1]?arguments[1]:{};a=arguments[0]}r.html(t(c,i));o(r);u(r);if(n.tag[a]){n.tag[a]=r.get(0)}return r.get(0)};n.tpl[a]=h})}function f(e){var t=null,n=null,r=null;if(e){if(e.indexOf("#")!=-1){var i=e.split("#");r=i[1],e=i[0]}if(e.indexOf(":")!=-1){var i=e.split(":");t=i[1],n=i[0]}else{n=e}}return{key:t,func:n,type:r}}function l(e){if(e.indexOf(",")!=-1){if(e.indexOf(":")!=-1)throw new Error("VOJS_BIND_ERR: bind array keys can not be used");var t=e.split(","),n=new Array;for(var r in t){n.push(f(t[r]))}return n}return f(e)}function c(e,t,n){var r=$(t).data("bind"),i=l(r),s=i.length>0?i:[i];for(var o in s){if(s[o].func==e){var u=s[o].type;if(!u){if(t.value==undefined)$(t).html(n);else $(t).val(n)}else{if(u.indexOf(".")!=-1){var a=u.split(".");if(a[0]=="css"){$(t).css(a[1],n)}else if(a[0]=="attr"){$(t).attr(a[1],n)}}else{$(t).css(u,n)}}}}}function h(e){var t=new Object;for(var r in e){var i=e[r];if(!t[i.name])t[i.name]=[];t[i.name].push(i.elem)}for(var s in t){(function(e){n.bindMultiProc=function(n){var r=t[e];for(var i=0;i<r.length;i++){var s=r[i];c(e,s,n)}return r.length>1?r:r[0]}})(s);n.bind[s]=n.bindMultiProc}}function p(e){for(var t in e){var r=e[t].func;(function(t){n.funcMultiProc=function(n,r){var s=i(e,t,n);c(t,s,r);return s}})(r);function i(e,t,n){for(var r in e){var i=e[r];if(i.func==t&&i.key==n){return i.data}}}n.bind[r]=n.funcMultiProc}}function d(e,t,n){function s(e){if(e.value==undefined)return $(e).html();else return $(e).val()}function o(t){var n=t.cmd,r=t.elem;if(e=="bind"){if(!n.type){return s(r)}else{if(n.type.indexOf(".")!=-1){var i=n.type.split(".");if(i[0]=="css"){return $(r).css(i[1])}else if(i[1]=="attr"){return $(r).attr(i[1])}}else{return $(r).css(n.type)}}}else{return s(r)}}var r="[data-"+e+"]"+(e=="tag"?",#"+t:""),i=[];$(r).each(function(n){var r=$(this).data(e);if(e=="tag"&&!r)r=this.id;var s=f(r);if(t==s.func){i.push({cmd:s,elem:this})}});return function(e){if(e.length==1&&!e[0].cmd.key){if(n)return e[0].elem;else return o(e[0])}else{var r=new Object,i=0;for(var s=0;s<e.length;s++){var u=e[s].cmd;if(u.key){t=u.key}else{t=i;i++}if(n)r[t]=e[s].elem;else r[t]=o(e[s])}return r}}(i)}var n=this;n.root=e?$("#"+e).get(0):$("body").get(0),n.act={},n.bind={},n.tag={},n.tpl={};n.bind.get=function(e){return d("bind",e,true)};n.tag.get=function(e){return d("tag",e,true)};n.act.get=function(e){return d("act",e,true)};n.bind.val=function(e){return d("bind",e,false)};n.tag.val=function(e){return d("tag",e,false)};n.act.val=function(e){return d("act",e,false)};r()};r.applyTo=function(e,t){if(typeof e!="object")throw new Error("VOJS_CRITICAL_ERR: is not an object");$.extend(e,new r(t))};r.appendTo=function(e,t,i,s){var o=n(e,t,i,s);o.targetSel.append(o.tplHtml);r.applyTo(e,o.viewId)};r.prependTo=function(e,t,i,s){var o=n(e,t,i,s);o.targetSel.prepend(o.tplHtml);r.applyTo(e,o.viewId)};r.includeTpl=function(){var e=r.includePath?r.includePath:"",t=r.includeExt?r.includeExt:"tpl",n=arguments.length;if(typeof arguments[n-1]=="object"){var i=arguments[n-1];e=i.path?i.path:e;t=i.ext?i.ext:t}for(var s in arguments){var o=arguments[s],u="",a="body";if(typeof o=="string"){if(o.indexOf(":")!=-1){var f=o.split(":"),a="#"+f[0],u=e+"/"+f[1]+"."+t}else{u=e+"/"+o+"."+t}$.ajax({url:u,method:"GET",async:false,success:function(e){$(a).append(e)}})}}};r.template=function(e,n,r){return t(e,n,r)};e.vo=r})(window)